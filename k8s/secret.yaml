# k8s/secret.yaml
# IMPORTANT: This is a TEMPLATE file. DO NOT commit actual secrets to version control.
# Use one of these methods to manage secrets in production:
# 1. Sealed Secrets (bitnami-labs/sealed-secrets)
# 2. External Secrets Operator (external-secrets/external-secrets)
# 3. HashiCorp Vault
# 4. AWS Secrets Manager / Azure Key Vault / GCP Secret Manager
# 5. kubectl create secret from files/literals

apiVersion: v1
kind: Secret
metadata:
  name: agent-service-secrets
  namespace: agent-service
  labels:
    app: agent-service
    app.kubernetes.io/name: agent-service
    app.kubernetes.io/component: secrets
type: Opaque
stringData:
  # Database credentials
  # Replace with actual values or use external secret management
  DATABASE_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"
  DATABASE_URL: "postgresql://agent_service:REPLACE_WITH_SECURE_PASSWORD@postgres-service.agent-service.svc.cluster.local:5432/agent_db"

  # Redis password (if enabled)
  REDIS_PASSWORD: "REPLACE_WITH_SECURE_PASSWORD"
  REDIS_URL: "redis://:REPLACE_WITH_SECURE_PASSWORD@redis-service.agent-service.svc.cluster.local:6379/0"

  # Application secrets
  SECRET_KEY: "REPLACE_WITH_RANDOM_SECRET_KEY_MIN_32_CHARS"
  JWT_SECRET_KEY: "REPLACE_WITH_JWT_SECRET_KEY"

  # API keys for external services
  OPENAI_API_KEY: "sk-REPLACE_WITH_ACTUAL_KEY"
  ANTHROPIC_API_KEY: "sk-ant-REPLACE_WITH_ACTUAL_KEY"

  # Sentry DSN
  SENTRY_DSN: "https://REPLACE_WITH_SENTRY_DSN@sentry.io/PROJECT_ID"

  # OAuth/OIDC credentials (if using)
  OAUTH_CLIENT_ID: "REPLACE_WITH_CLIENT_ID"
  OAUTH_CLIENT_SECRET: "REPLACE_WITH_CLIENT_SECRET"

  # Azure AD (if using)
  AZURE_AD_CLIENT_ID: "REPLACE_WITH_AZURE_CLIENT_ID"
  AZURE_AD_CLIENT_SECRET: "REPLACE_WITH_AZURE_CLIENT_SECRET"
  AZURE_AD_TENANT_ID: "REPLACE_WITH_AZURE_TENANT_ID"

  # AWS Cognito (if using)
  AWS_COGNITO_USER_POOL_ID: "REPLACE_WITH_POOL_ID"
  AWS_COGNITO_CLIENT_ID: "REPLACE_WITH_CLIENT_ID"
  AWS_COGNITO_CLIENT_SECRET: "REPLACE_WITH_CLIENT_SECRET"
  AWS_REGION: "us-east-1"

  # Encryption keys
  ENCRYPTION_KEY: "REPLACE_WITH_ENCRYPTION_KEY_BASE64"

---
# Example: Using External Secrets Operator
# apiVersion: external-secrets.io/v1beta1
# kind: ExternalSecret
# metadata:
#   name: agent-service-secrets
#   namespace: agent-service
# spec:
#   refreshInterval: 1h
#   secretStoreRef:
#     name: aws-secrets-manager  # or azure-keyvault, vault, etc.
#     kind: SecretStore
#   target:
#     name: agent-service-secrets
#     creationPolicy: Owner
#   data:
#     - secretKey: DATABASE_PASSWORD
#       remoteRef:
#         key: agent-service/database
#         property: password
#     - secretKey: SECRET_KEY
#       remoteRef:
#         key: agent-service/app
#         property: secret_key
#     - secretKey: OPENAI_API_KEY
#       remoteRef:
#         key: agent-service/api-keys
#         property: openai

---
# Example: Using Sealed Secrets
# Generate sealed secret with:
# kubectl create secret generic agent-service-secrets \
#   --from-literal=DATABASE_PASSWORD=xxx \
#   --from-literal=SECRET_KEY=xxx \
#   --dry-run=client -o yaml | \
#   kubeseal -o yaml > sealed-secret.yaml

# apiVersion: bitnami.com/v1alpha1
# kind: SealedSecret
# metadata:
#   name: agent-service-secrets
#   namespace: agent-service
# spec:
#   encryptedData:
#     DATABASE_PASSWORD: AgBy3i4OJSWK+PiTySYZZA9rO43cGDEq...
#     SECRET_KEY: AgBy3i4OJSWK+PiTySYZZA9rO43cGDEq...

---
# TLS Secret for Ingress (managed by cert-manager)
# This is auto-generated by cert-manager, included here for reference
apiVersion: v1
kind: Secret
metadata:
  name: agent-service-tls
  namespace: agent-service
  labels:
    app: agent-service
type: kubernetes.io/tls
data:
  # These will be populated by cert-manager
  tls.crt: ""
  tls.key: ""
