# k8s/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: agent-service-config
  namespace: agent-service
  labels:
    app: agent-service
    app.kubernetes.io/name: agent-service
    app.kubernetes.io/component: config
data:
  # Application configuration
  ENVIRONMENT: "production"
  DEBUG: "false"
  LOG_LEVEL: "INFO"

  # API configuration
  API_VERSION: "v1"
  API_TITLE: "Agent Service API"
  API_DESCRIPTION: "Production AI Agent Service"

  # Database configuration (non-sensitive parts)
  DATABASE_HOST: "postgres-service.agent-service.svc.cluster.local"
  DATABASE_PORT: "5432"
  DATABASE_NAME: "agent_db"
  DATABASE_USER: "agent_service"
  DATABASE_POOL_SIZE: "20"
  DATABASE_MAX_OVERFLOW: "10"

  # Redis configuration
  REDIS_HOST: "redis-service.agent-service.svc.cluster.local"
  REDIS_PORT: "6379"
  REDIS_DB: "0"
  REDIS_MAX_CONNECTIONS: "50"

  # Celery configuration
  CELERY_BROKER_URL: "redis://redis-service.agent-service.svc.cluster.local:6379/1"
  CELERY_RESULT_BACKEND: "redis://redis-service.agent-service.svc.cluster.local:6379/2"
  CELERY_TASK_ALWAYS_EAGER: "false"
  CELERY_TASK_SERIALIZER: "json"
  CELERY_RESULT_SERIALIZER: "json"
  CELERY_ACCEPT_CONTENT: "json"
  CELERY_TIMEZONE: "UTC"
  CELERY_ENABLE_UTC: "true"

  # CORS configuration
  CORS_ORIGINS: "https://yourdomain.com,https://app.yourdomain.com"
  CORS_ALLOW_CREDENTIALS: "true"
  CORS_ALLOW_METHODS: "GET,POST,PUT,DELETE,OPTIONS"
  CORS_ALLOW_HEADERS: "Content-Type,Authorization,X-Request-ID"

  # Rate limiting
  RATE_LIMIT_ENABLED: "true"
  RATE_LIMIT_PER_MINUTE: "60"
  RATE_LIMIT_PER_HOUR: "1000"

  # Security
  ALLOWED_HOSTS: "api.yourdomain.com,agent-service.yourdomain.com"

  # Observability
  METRICS_ENABLED: "true"
  TRACING_ENABLED: "true"
  TRACING_SAMPLE_RATE: "0.1"

  # OpenTelemetry configuration
  OTEL_SERVICE_NAME: "agent-service-api"
  OTEL_EXPORTER_OTLP_ENDPOINT: "http://otel-collector.observability.svc.cluster.local:4317"

  # Sentry configuration
  SENTRY_ENABLED: "true"
  SENTRY_ENVIRONMENT: "production"
  SENTRY_TRACES_SAMPLE_RATE: "0.1"

  # Feature flags
  FEATURE_AUTH_ENABLED: "true"
  FEATURE_RATE_LIMITING: "true"
  FEATURE_CACHING: "true"

  # Worker configuration
  WORKER_CONCURRENCY: "4"
  WORKER_MAX_TASKS_PER_CHILD: "1000"
  WORKER_PREFETCH_MULTIPLIER: "4"
